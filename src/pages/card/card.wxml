<view class="container">
    <view wx:if="{{cardDetail}}" class="title-container">
        <text wx:if="{{cardDetail.title}}" class="card-title">{{cardDetail.title}}</text>
        <view class="user-container">
            <image class="user-avatar"
                data-user="{{cardDetail.user.id}}"
                bindtap="onUserTap"
                src="{{cardDetail.user.avatar}}" />
            <view class="user-time-container"
                data-user="{{cardDetail.user.id}}"
                bindtap="onUserTap">
                <text class="user-nickname">{{cardDetail.user.nickname}}</text>
                <text class="card-date">{{cardDetail.timeString}}</text>
            </view>
            <view class="card-count-container">
                <view wx:if="{{cardDetail.readCount || cardDetail.readCount === 0}}"
                    class="card-read-count">
                    {{cardDetail.readCount}} 次浏览
                </view>
                <view wx:if="{{cardDetail.approvalCount || cardDetail.approvalCount === 0}}"
                    class="card-approval-count"
                    bindtap="onShowApprovalUser">
                    {{cardDetail.approvalCount}} 个赞
                </view>
            </view>
        </view>
    </view>
    <view wx:if="{{showApprovalUser && cardDetail.approvalList && cardDetail.approvalList.length > 0}}"
        class="approval-user-container">
        <block wx:for="{{cardDetail.approvalList}}" wx:key="index">
            <image class="approval-user-avatar"
                data-user="{{item.id}}"
                bindtap="onUserTap"
                src="{{item.avatar}}" />
        </block>
    </view>
    <view wx:if="{{showApprovalUser && cardDetail.approvalList && cardDetail.approvalList.length > 0}}"
        class="approval-detail-container">
        <text class="approval-detail-text">共 {{cardDetail.approvalCount}} 个用户赞过</text>
        <text class="hide-approval-text"
            bindtap="onHideApprovalUser">收起</text>
    </view>
    <view wx:if="{{cardDetail.picUrl}}" class="img-container">
        <image class="card-img" src="{{cardDetail.picUrl}}" mode="widthFix" />
    </view>
    <view class="content-container">
        <text class="card-content">
            {{cardDetail.content}}
        </text>
    </view>
    <view wx:if="{{cardDetail.book}}"
        class="book-container"
        data-isbn="{{cardDetail.book.isbn}}"
        bindtap="onBookTap">
        <image class="book-pic" src="{{cardDetail.book.cover}}" mode="aspectFit" />
        <view class="book-detail-container">
            <text class="book-title-extra">相关图书</text>
            <text class="book-title">《{{cardDetail.book.title}}》</text>
            <text class="book-author">作者：{{cardDetail.book.author}}</text>
        </view>
    </view>
    <view class="card-bottom-space-holder" />
    <view wx:if="{{cardDetail && cardDetail.isMe && !fromList}}" class="bottom-bar-container">
        <view class="bottom-container" bindtap="onDelete">
            <image class="bottom-icon"
                src="../../resources/img/icon_card_delete.png" />
            <text class="bottom-text">删除</text>
        </view>
        <view class="bottom-container" bindtap="onModify">
            <image class="bottom-icon"
                src="../../resources/img/icon_edit.png" />
            <text class="bottom-text">修改</text>
        </view>
        <button class="bottom-btn"
            hover-class="bottom-btn-hover"
            open-type="share">
            <image class="bottom-icon"
                src="../../resources/img/icon_share.png" />
            <text class="bottom-text">分享</text>
        </button>
    </view>
    <view wx:elif="{{cardDetail}}" class="bottom-bar-container">
        <view wx:if="{{cardDetail.hasApproved}}"
            class="bottom-container-3" bindtap="onApprovalChange">
            <image class="bottom-icon"
                src="../../resources/img/icon_approval_selected.png" />
            <text class="bottom-text-selected">已点赞</text>
        </view>
        <view wx:else class="bottom-container-3" bindtap="onApprovalChange">
            <image class="bottom-icon"
                src="../../resources/img/icon_approval.png" />
            <text class="bottom-text">点赞</text>
        </view>
        <button class="bottom-btn-2"
            hover-class="bottom-btn-hover"
            open-type="share">
            <image class="bottom-icon"
                src="../../resources/img/icon_share.png" />
            <text class="bottom-text">分享</text>
        </button>
    </view>
</view>